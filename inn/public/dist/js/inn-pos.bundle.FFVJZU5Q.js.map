{
  "version": 3,
  "sources": ["../../../../../apps/inn/inn/inn_hotels/page/pos_extended/pos_extended_itemcart.js", "../../../../../apps/inn/inn/inn_hotels/page/pos_extended/pos_extended_pastordersummary.js"],
  "sourcesContent": ["frappe.require([\"point-of-sale.bundle.js\", \"inn-pos.bundle.js\"], function () {\n    inn.PointOfSale.PosExtendItemCart = class PosExtendItemCart extends erpnext.PointOfSale.ItemCart {\n        constructor({ wrapper, events, settings }) {\n            super({ wrapper, events, settings });\n        }\n        init_child_components() {\n            this.init_customer_selector();\n            this.init_table_selector();\n            this.init_cart_components();\n        }\n\n        init_table_selector() {\n            this.$component.append(\n                `<div class=\"table-section\"></div>`\n            )\n            this.$table_section = this.$component.find('.table-section');\n            this.make_table_selector();\n        }\n\n\n        make_table_selector() {\n            this.$table_section.html(`<div class=\"table-field\"></div>`)\n            const me = this;\n            this.table_field = frappe.ui.form.make_control({\n                df: {\n                    label: __('No Table'),\n                    fieldtype: 'Link',\n                    options: 'Inn Point Of Sale Table',\n                    placeholder: __('Search table number'),\n                    get_query: function () {\n                        return {\n                            filters: [\n                                [\"Inn Point Of Sale Table\", \"status\", \"=\", \"Empty\"]\n                            ]\n                        }\n                    },\n                    onchange: function () {\n                        me[\"table_number\"] = this.get_value()\n                        me.events.get_frm().dirty()\n                    }\n                },\n                parent: this.$table_section.find('.table-field'),\n                render_input: true,\n            });\n            this.table_field.toggle_label(false);\n        }\n\n        load_invoice() {\n            super.load_invoice()\n\n            const frm = this.events.get_frm()\n            const me = this\n            let table_number = undefined\n\n            frappe.call({\n                method: \"inn.inn_hotels.page.pos_extended.pos_extended.get_table_number\",\n                args: {\n                    invoice_name: frm.doc.name\n                },\n                async: false,\n                callback: function (r) {\n                    table_number = r.message\n                    me.$table_section.find(\"input\").val(table_number)\n                    me.table_number = table_number\n                }\n            })\n        }\n\n        make_cart_totals_section() {\n            this.$totals_section = this.$component.find('.cart-totals-section');\n\n            this.$totals_section.append(\n                `<div class=\"add-discount-wrapper\">\n                ${this.get_discount_icon()} ${__('Add Discount')}\n            </div>\n            <div class=\"item-qty-total-container\">\n                <div class=\"item-qty-total-label\">${__('Total Items')}</div>\n                <div class=\"item-qty-total-value\">0.00</div>\n            </div>\n            <div class=\"net-total-container\">\n                <div class=\"net-total-label\">${__(\"Net Total\")}</div>\n                <div class=\"net-total-value\">0.00</div>\n            </div>\n            <div class=\"taxes-container\"></div>\n            <div class=\"grand-total-container\">\n                <div>${__('Grand Total')}</div>\n                <div>0.00</div>\n            </div>\n            <div class=\"print-order-section\">\n                <div class=\"caption-order-btn\" data-button-value=\"captain-order\">${__('Captain Order')}</div>\n                <div class=\"table-order-btn\" data-button-value=\"table-order\">${__('Table Order')}</div>\n            </div>\n            <div class=\"checkout-btn\">${__('Checkout')}</div>\n            <div class=\"edit-cart-btn\">${__('Edit Cart')}</div>`\n            )\n\n            this.$add_discount_elem = this.$component.find(\".add-discount-wrapper\");\n        }\n\n        highlight_checkout_btn(toggle) {\n            super.highlight_checkout_btn(toggle)\n            if (toggle) {\n                this.$cart_container.find('.caption-order-btn').css({\n                    'background-color': 'var(--gray-800)'\n                });\n                this.$cart_container.find('.table-order-btn').css({\n                    'background-color': 'var(--gray-800)'\n                });\n            } else {\n                this.$cart_container.find('.caption-order-btn').css({\n                    'background-color': 'var(--gray-300)'\n                });\n                this.$cart_container.find('.table-order-btn').css({\n                    'background-color': 'var(--gray-300)'\n                });\n            }\n        }\n\n        bind_events() {\n            super.bind_events()\n\n            const me = this;\n            this.$component.on(\"click\", \".caption-order-btn\", async function () {\n                if ($(this).attr('style').indexOf('--gray-800') == -1) return;\n\n                await me.events.print_captain_order();\n            })\n\n            this.$component.on(\"click\", \".table-order-btn\", async function () {\n                if ($(this).attr('style').indexOf('--gray-800') == -1) return;\n\n                await me.events.print_table_order();\n            })\n        }\n    }\n})\n\nexport default inn.PointOfSale.PosExtendItemCart", "frappe.require([\"point-of-sale.bundle.js\"], function () {\n\n    inn.PointOfSale.PosExtendPastOrderSummary = class PosExtendPastOrderSummary extends erpnext.PointOfSale.PastOrderSummary {\n        constructor({ wrapper, events }) {\n            super({ wrapper, events })\n        }\n\n        async attach_document_info(doc) {\n            await frappe.db.get_value('Customer', this.doc.customer, 'email_id').then(({ message }) => {\n                doc.customer_email = message.email_id || '';\n            });\n\n            const upper_section_dom = this.get_upper_section_html(doc);\n            this.$upper_section.html(upper_section_dom);\n        }\n\n        bind_events() {\n            super.bind_events();\n\n            this.$summary_container.on('click', '.show-btn', () => {\n                console.log(this.doc)\n                this.events.print_bill(this.doc)\n            });\n        }\n\n        get_condition_btn_map(after_submission) {\n            if (after_submission)\n                return [{ condition: true, visible_btns: ['Print Receipt', 'Email Receipt', 'New Order'] }];\n\n            return [\n                { condition: this.doc.docstatus === 0, visible_btns: ['Show Bill', 'Edit Order', 'Delete Order'] },\n                { condition: !this.doc.is_return && this.doc.docstatus === 1, visible_btns: ['Print Receipt', 'Email Receipt', 'Return'] },\n                { condition: this.doc.is_return && this.doc.docstatus === 1, visible_btns: ['Print Receipt', 'Email Receipt'] }\n            ];\n        }\n\n        print_receipt() {\n            const frm = this.events.get_frm();\n            frappe.utils.print(\n                this.doc.doctype,\n                this.doc.name,\n                \"POS Extended Invoice\",\n                this.doc.letter_head,\n                this.doc.language || frappe.boot.lang\n            );\n        }\n\n        get_upper_section_html(doc) {\n            const { status } = doc;\n            let indicator_color = '';\n\n            in_list(['Paid', 'Consolidated'], status) && (indicator_color = 'green');\n            status === 'Draft' && (indicator_color = 'red');\n            status === 'Return' && (indicator_color = 'grey');\n\n            var table_number = undefined\n\n            frappe.call({\n                method: \"inn.inn_hotels.page.pos_extended.pos_extended.get_table_number\",\n                args: {\n                    invoice_name: doc.name\n                },\n                async: false,\n                callback: function (r) {\n                    table_number = r.message\n                }\n            })\n\n            return `<div class=\"left-section\">\n                    <div class=\"customer-name\">${doc.customer}</div>\n                    <div class=\"customer-email\">${doc.customer_email}</div>\n                    <div class=\"table-number\">${__('Table')}: ${table_number}</div>\n                    <div class=\"cashier\">${__('Sold by')}: ${doc.owner}</div>\n                </div>\n                <div class=\"right-section\">\n                    <div class=\"paid-amount\">${format_currency(doc.paid_amount, doc.currency)}</div>\n                    <div class=\"invoice-name\">${doc.name}</div>\n                    <span class=\"indicator-pill whitespace-nowrap ${indicator_color}\"><span>${doc.status}</span></span>\n                </div>`;\n        }\n    }\n\n})"],
  "mappings": "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",
  "names": ["wrapper", "events", "settings", "me", "frm", "table_number", "r", "toggle", "pos_extended_itemcart_default", "wrapper", "events", "doc", "message", "upper_section_dom", "after_submission", "frm", "status", "indicator_color", "table_number", "r"]
}
